load("@rules_proto//proto:defs.bzl", "proto_library")
load("@build_stack_rules_proto//rules:proto_compile.bzl", "proto_compile")

# ----------------------------------------------------
# Configuation of the 'cc_proto' plugin
# ----------------------------------------------------
# gazelle:proto_plugin cc_proto @build_stack_rules_proto//cc:proto_plugin
# gazelle:proto_plugin cc_grpc @build_stack_rules_proto//cc:grpc_plugin

# ----------------------------------------------------
# Configuration of the 'cc' proto_language
# ----------------------------------------------------
# gazelle:proto_language cc kind cc_library
# gazelle:proto_language cc load @rules_cc//:deps.bzl
# gazelle:proto_language cc plugin cc_proto
# gazelle:proto_language cc plugin cc_grpc
# gazelle:proto_language cc enable true

proto_library(
    name = "example_proto",
    srcs = [
        "api.proto",
        "thing.proto",
    ],
    visibility = ["//visibility:public"],
    deps = ["@com_google_protobuf//:timestamp_proto"],
)

proto_compile(
    name = "example_cc_compile",
    generated_srcs = [
        "thing_pb.cc",
        "api_pb_grpc.cc",
    ],
    plugins = [
        "@build_stack_rules_proto//cc:proto_plugin",
        "@build_stack_rules_proto//cc:grpc_plugin",
    ],
)
