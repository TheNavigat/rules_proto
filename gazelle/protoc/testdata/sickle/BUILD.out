load("@rules_proto//proto:defs.bzl", "proto_library")
load("@build_stack_rules_proto//rules/proto:proto_compile_test.bzl", "proto_compile_test")
load("//bazel/python:defaults.bzl", "py_abc_proto_compile", "py_library", "py_proto_compile")

# gazelle:proto package
# gazelle:proto_language py

proto_library(
    name = "events_proto",
    srcs = ["sickle.proto"],
    visibility = ["//visibility:public"],
    deps = [
        "//rosetta/rosetta:rosetta_proto",
        "//rosetta/rosetta/common:common_proto",
        "//rosetta/rosetta/events:events_proto",
        "//rosetta/rosetta/ledger:ledger_proto",
        "@com_google_protobuf//:struct_proto",
        "@com_google_protobuf//:timestamp_proto",
        "@com_google_protobuf//:wrappers_proto",
    ],
)

py_proto_compile(
    name = "events_py_proto_compile",
    deps = [":events_proto"],
)

proto_compile_test(
    name = "events_py_proto_compile_test",
    srcs = ["sickle_pb2.py"],
    rule = ":events_py_proto_compile",
    visibility = ["//visibility:private"],
)

py_abc_proto_compile(
    name = "events_py_abc_proto_compile",
    deps = [":events_proto"],
)

proto_compile_test(
    name = "events_py_abc_proto_compile_test",
    srcs = ["sickle_abc.py"],
    rule = ":events_py_abc_proto_compile",
    visibility = ["//visibility:private"],
)

py_library(
    name = "events_py_library",
    srcs = [
        "sickle_abc.py",
        "sickle_pb2.py",
    ],
    imports = [".."],
    deps = [
        "//rosetta/rosetta:rosetta_py_library",
        "//rosetta/rosetta/common:common_py_library",
        "//rosetta/rosetta/events:events_py_library",
        "//rosetta/rosetta/ledger:ledger_py_library",
    ],
)
