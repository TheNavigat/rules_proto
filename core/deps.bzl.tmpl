load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive", "http_file")

def _maybe(repo_rule, name, **kwargs):
    if name not in native.existing_rules():
        repo_rule(name = name, **kwargs)

def {{ .Rule.Name }}_deps():{{ range .RuleDeps }}{{ if ne .Dep.RepositoryRule "phony" }}
    {{ .Dep.Name }}()  # via {{ .ParentName }}{{ end }}{{ end }}

{{ range .RuleDeps }}{{ if ne .Dep.RepositoryRule "phony" }}

def {{ .Dep.Name }}():
    _maybe(
        {{ .Dep.RepositoryRule }},
        name = "{{ .Dep.Name }}",{{ if .Dep.Sha256 }}
        sha256 = "{{ .Dep.Sha256 }}",{{ end }}{{ if .Dep.StripPrefix }}
        strip_prefix = "{{ .Dep.StripPrefix }}",{{ end }}{{ if .Dep.Urls }}
        urls = [{{ range .Dep.Urls }}
            "{{ . }}",{{ end }}
        ],{{ end }}{{ if .Dep.BuildFile }}
        build_file = "{{ .Dep.BuildFile }}",{{ end }}
    ){{ end }}{{ end }}